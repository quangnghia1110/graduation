<!doctype html>
<html data-n-head-ssr dir="ltr" lang="vi">
<head>
    <title>Lễ Tốt Nghiệp - LÊ PHƯƠNG HÀ</title>
    <meta data-n-head="ssr" charset="utf-8">
    <meta data-n-head="ssr" name="viewport" content="width=device-width, initial-scale=1">
    <meta data-n-head="ssr" data-hid="robots" name="robots" content="noindex,nofollow">
    <meta data-n-head="ssr" data-hid="og:title" property="og:title" content="Lễ Tốt Nghiệp">
    <meta data-n-head="ssr" data-hid="description" property="og:description" content="Thân mời bạn dự lễ tốt nghiệp">
    <meta data-n-head="ssr" data-hid="og:description" property="og:description" content="Thân mời bạn dự lễ tốt nghiệp">
    <link data-n-head="ssr" rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Inter&amp;wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&amp;display=swap">
    <link data-n-head="ssr" rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lora&amp;display=swap">
    <link data-n-head="ssr" rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <link data-n-head="ssr" rel="stylesheet" href="https://unpkg.com/aos@2.3.1/dist/aos.css">
    <link data-n-head="ssr" rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css">
    <link data-n-head="ssr" href="https://fonts.googleapis.com/css2?family=Meow+Script&amp;display=swap"
        rel="stylesheet">
    <link data-n-head="ssr"
        href="https://fonts.googleapis.com/css2?family=Roboto:wght@100;300;400;500;700;900&amp;display=swap"
        rel="stylesheet">
    <script type="text/javascript" async=""
        src="https://www.googletagmanager.com/gtag/js?id=G-N1GKL21Y54&amp;l=dataLayer&amp;cx=c"></script>
    <script async="" src="https://cdn.jsdelivr.net/npm/yandex-metrica-watch/tag.js"></script>
    <script type="text/javascript" async="" src="https://www.googleadservices.com/pagead/conversion_async.js"></script>
    <script type="text/javascript" async="" src="https://www.google-analytics.com/analytics.js"></script>
    <script async="" src="https://www.googletagmanager.com/gtm.js?id=GTM-KX29S7T"></script>
    <script data-n-head="ssr" data-hid="gtm-script">window['dataLayer'] = []; if (!window._gtm_init) { window._gtm_init = 1; (function (w, n, d, m, e, p) { w[d] = (w[d] == 1 || n[d] == 'yes' || n[d] == 1 || n[m] == 1 || (w[e] && w[e][p] && w[e][p]())) ? 1 : 0 })(window, navigator, 'doNotTrack', 'msDoNotTrack', 'external', 'msTrackingProtectionEnabled'); (function (w, d, s, l, x, y) { w[x] = {}; w._gtm_inject = function (i) { if (w.doNotTrack || w[x][i]) return; w[x][i] = 1; w[l] = w[l] || []; w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' }); var f = d.getElementsByTagName(s)[0], j = d.createElement(s); j.async = true; j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i; f.parentNode.insertBefore(j, f); } })(window, document, 'script', 'dataLayer', '_gtm_ids', '_gtm_inject') };["GTM-KX29S7T"].forEach(function (i) { window._gtm_inject(i) })</script>
    <link rel="stylesheet" href="./css/style1.css">
    <link rel="stylesheet" href="./css/style2.css">
    <link rel="stylesheet" href="./css/style3.css">
    <link rel="stylesheet" href="./css/style4.css">
    <link rel="stylesheet" href="./css/style5.css">
    <link rel="stylesheet" href="./css/style6.css">
    <link rel="stylesheet" href="./css/style7.css">
    <link rel="stylesheet" href="./css/style8.css">
    <link rel="stylesheet" href="./css/style9.css">
    <link rel="stylesheet" href="./css/namtay.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://unpkg.com/boxicons@2.1.1/css/boxicons.min.css" rel="stylesheet">
    <link rel="stylesheet" href="./css/styles10.css">
    <script src="https://cdn.jsdelivr.net/npm/@splidejs/splide@4.1.4/dist/js/splide.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/@splidejs/splide@4.1.4/dist/css/splide.min.css" rel="stylesheet">
    </link>
    <style>
        /* Thêm CSS của bạn ở đây */
        body {
            font-family: 'Lora', serif;
            background-color: #f9f7f7;
            color: #333;
            pointer-events: auto !important;
        }
        .invitation-container {
            max-width: 800px;
            margin: 50px auto;
            padding: 40px;
            background-color: white;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border-radius: 15px;
            text-align: center;
        }
        .invitation-header {
            font-family: 'Meow Script', cursive;
            color: #002366;
            font-size: 42px;
            margin-bottom: 20px;
        }
        .guest-name-container {
            margin: 30px 0;
            padding: 15px;
            border: 1px dashed #e0e0e0;
            background-color: #f9f7f7;
            border-radius: 10px;
        }
        #invitation {
            font-weight: bold;
            font-size: 28px;
            color: #002366;
            display: block !important;
        }
        .invitation-details {
            margin: 40px 0;
            line-height: 1.8;
        }
        .invitation-footer {
            margin-top: 40px;
            font-style: italic;
        }
    </style>
</head>
<body style="pointer-events: auto !important;">
    <div class="no-fb-chat" data-n-head="%7B%22class%22:%7B%22ssr%22:%5B%22no-fb-chat%22%5D%7D%7D">
        <div id="__nuxt">
            <div id="__layout">
                <div class="ws">
                    <div id="section-popup-qr"></div>
                    <div id="section-loading"></div>
                    <div class="pageMain">
                        <div class="t8">
                            <div id="section-banner">
                                <div class="invitation-container">
                                    <div class="invitation-header">
                                        <h1>Lễ Tốt Nghiệp</h1>
                                        <h2>LÊ PHƯƠNG HÀ</h2>
                                    </div>
                                    
                                    <div class="guest-name-container">
                                        <p>Kính mời:</p>
                                        <div class="guest_name" id="invitation" style="display:block;"></div>
                                        <p>đến dự buổi lễ tốt nghiệp</p>
                                    </div>
                                    
                                    <div class="invitation-details">
                                        <p><strong>Thời gian:</strong> 9:00 - 11:30, Ngày 20 tháng 6 năm 2024</p>
                                        <p><strong>Địa điểm:</strong> Hội trường A1, Đại học ABC</p>
                                        <p><strong>Dress code:</strong> Smart casual</p>
                                    </div>
                                    
                                    <div class="invitation-footer">
                                        <p>Rất mong được đón tiếp!</p>
                                    </div>
                                </div>
                            </div>
                            <div id="section-location"></div>
                            <div id="section-bio"></div>
                            <div id="section-journey"></div>
                            <div id="section-gallery"></div>
                            <div id="section-event"></div>
                            <div id="section-contact"></div>
                            <div id="section-footer"></div>
                        </div>
                        <div id="section-donate-button"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/2.0.2/anime.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.7/ScrollMagic.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/protonet-jquery.inview/1.1.2/jquery.inview.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', async function() {
            const urlParams = new URLSearchParams(window.location.search);
            const id = urlParams.get('id');
            const name = urlParams.get('name');

            // Remove pointer-events restriction
            document.body.style.pointerEvents = 'auto';

            // Nếu truy cập trực tiếp vào index.html mà không có params
            if (!id || !name) {
                window.location.href = '/create-invitation.html';
                return;
            }

            // Kiểm tra ID có trong sheet không
            try {
                const sheetId = '17T4wP-l1KSm0iyqdWFMZyKUsJ0RFn8gCFNzKrTlG9RE';
                const response = await fetch(`https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json`);
                const text = await response.text();
                const data = JSON.parse(text.substr(47).slice(0, -2));
                
                // Tìm ID trong sheet
                const found = data.table.rows.some(row => row.c[0] && row.c[0].v === id);
                if (!found) {
                    showErrorPage("ID không tồn tại trong hệ thống");
                    return;
                }
            } catch (error) {
                console.error('Lỗi khi kiểm tra sheet:', error);
            }

            const guestName = urlParams.get('name');
            if (guestName) {
                const invitationElement = document.getElementById('invitation');
                if (invitationElement) {
                    invitationElement.textContent = decodeURIComponent(guestName);
                    invitationElement.style.display = 'block';
                    console.log("Đã cập nhật tên khách thành công");
                } else {
                    console.log("Không tìm thấy element 'invitation'");
                    // Create it if it doesn't exist
                    const container = document.querySelector('.guest-name-container') || document.getElementById('section-banner');
                    if (container) {
                        const nameElement = document.createElement('div');
                        nameElement.id = 'invitation';
                        nameElement.className = 'guest_name';
                        nameElement.style.display = 'block';
                        nameElement.textContent = decodeURIComponent(guestName);
                        container.appendChild(nameElement);
                    }
                }
            }
        });

        function showErrorPage(message) {
            document.body.innerHTML = `
                <div style="text-align: center; margin-top: 50px;">
                    <h2>Lỗi</h2>
                    <p>${message}</p>
                    <button onclick="window.location.href='create-invitation.html'">Quay lại trang tạo thiệp</button>
                </div>
            `;
        }
    </script>
</body>
</html>